select  IFNULL(c.brand_name,'Jiwok') as Brand,program_title,count(a.user_id) as Users
from user_master_ext a
left join brand_user b on b.user_id=a.user_id 
left join brand_master c on c.brand_master_id=b.brand_master_id 
left join countries d on a.user_country=d.countries_id
join
(
select ps.user_id as userid,program_id,program_title,subscribed_date from programs_subscribed ps,program_detail pd where 
ps.program_id=pd.program_master_id 
and pd.language_id=2 and ps.subscribe_status=1 order by ps.program_id
) b  on b.userid=a.user_id 
where subscribed_date BETWEEN '%3$s-%2$s-%1$s' and '%6$s-%5$s-%4$s' 
%7$s
%8$s
%9$s
%10$s
%11$s
%12$s
%13$s
%14$s
%15$s
%16$s
group by program_id
order by brand_name,Users desc;
